COPY    START   1000		COPY FILE FROM INPUT TO OUTPUT
-111
COPY
START

1000
COPY FILE FROM INPUT TO OUTPUT
0 0 0 
FIRST   STL     RETADR		SAVE RETURN ADDRESS
1000
FIRST
STL
0x14
RETADR
SAVE RETURN ADDRESS
0 0 0 
CLOOP   JSUB    RDREC		READ INPUT RECORD
1003
CLOOP
JSUB
0x48
RDREC
READ INPUT RECORD
0 0 0 
	LDA	LENGTH		TEST FOR EOF (LENGTH = 0)
1006

LDA
0x00
LENGTH
TEST FOR EOF (LENGTH = 0)
0 0 
	COMP    ZERO
1009

COMP
0x28
ZERO

0 0 
	JEQ     ENDFIL		EXIT IF EOF FOUND
100C

JEQ
0x30
ENDFIL
EXIT IF EOF FOUND
0 0 
	JSUB	WRREC		WRITE OUTPUT RECORD
100F

JSUB
0x48
WRREC
WRITE OUTPUT RECORD
0 0 
	J       CLOOP		LOOP
1012

J
0x3C
CLOOP
LOOP
0 0 
ENDFIL  LDA     EOF		INSERT END OF FILE MARKER
1015
ENDFIL
LDA
0x00
EOF
INSERT END OF FILE MARKER
0 0 0 
	STA     BUFFER
1018

STA
0x0C
BUFFER

0 0 
	LDA     THREE		SET LENGTH = 3
101B

LDA
0x00
THREE
SET LENGTH = 3
0 0 
	STA     LENGTH
101E

STA
0x0C
LENGTH

0 0 
	JSUB    WRREC		WRITE EOF
1021

JSUB
0x48
WRREC
WRITE EOF
0 0 
	LDL     RETADR		GET RETURN ADDRESS
1024

LDL
0x08
RETADR
GET RETURN ADDRESS
0 0 
	RSUB             	RETURN TO CALLER
1027

RSUB
0x4C

RETURN TO CALLER

EOF     BYTE    C'EOF'
102A
EOF
BYTE

C'EOF'

0 0 0 
THREE   WORD    3
102D
THREE
WORD

3

0 0 0 
ZERO    WORD    0
1030
ZERO
WORD

0

0 0 0 
RETADR  RESW    1
1033
RETADR
RESW

1

0 0 0 
LENGTH  RESW    1		LENGTH OF RECORD
1036
LENGTH
RESW

1
LENGTH OF RECORD
0 0 0 
BUFFER  RESB    4096		4096-BYTE BUFFER AREA
1039
BUFFER
RESB

4096
4096-BYTE BUFFER AREA
0 0 0 
.
-111




.
0
.	SUBROUTINE TO READ RECORD INTO BUFFER
-111




.	SUBROUTINE TO READ RECORD INTO BUFFER
0
.
-111




.
0
RDREC   LDX     ZERO		CLEAR LOOP COUNTER
2039
RDREC
LDX
0x04
ZERO
CLEAR LOOP COUNTER
0 0 0 
	LDA     ZERO		CLEAR A TO ZERO
203C

LDA
0x00
ZERO
CLEAR A TO ZERO
0 0 
RLOOP   TD      INPUT		TEST INPUT DEVICE
203F
RLOOP
TD
0xE0
INPUT
TEST INPUT DEVICE
0 0 0 
	JEQ     RLOOP		LOOP UNTIL READY
2042

JEQ
0x30
RLOOP
LOOP UNTIL READY
0 0 
	RD      INPUT		READ CHARACTER INTO REGISTAR A
2045

RD
0xD8
INPUT
READ CHARACTER INTO REGISTAR A
0 0 
	COMP    ZERO		TEST FOR END OF RECORD (X'00')
2048

COMP
0x28
ZERO
TEST FOR END OF RECORD (X'00')
0 0 
	JEQ     EXIT		EXIT LOOP IF EOF
204B

JEQ
0x30
EXIT
EXIT LOOP IF EOF
0 0 
	STCH    BUFFER,X	STORE CHARCTER IN BUFFER
204E

STCH
0x54
BUFFER,X
STORE CHARCTER IN BUFFER
0 0 
	TIX     MAXLEN		LOOP UNLESS MAX LENGTH
2051

TIX
0x2C
MAXLEN
LOOP UNLESS MAX LENGTH
0 0 
	JLT     RLOOP	  	  HAS BEEN REACHED
2054

JLT
0x38
RLOOP
HAS BEEN REACHED
0 0 
EXIT    STX     LENGTH		SAVE RECORD LENGTH
2057
EXIT
STX
0x10
LENGTH
SAVE RECORD LENGTH
0 0 0 
	RSUB                    RETURN TO CALLER
205A

RSUB
0x4C

RETURN TO CALLER

INPUT   BYTE    X'F1'		CODE FOR INPUT DEVICE
205D
INPUT
BYTE

X'F1'
CODE FOR INPUT DEVICE
0 0 0 
MAXLEN	WORD	4096
205E
MAXLEN
WORD

4096

0 0 0 
.
-111




.
0
.	SUBROUTINE TO WRITE RECORD FROM BUFFER
-111




.	SUBROUTINE TO WRITE RECORD FROM BUFFER
0
.
-111




.
0
WRREC   LDX    ZERO		CLEAR LOOP COUNTER
2061
WRREC
LDX
0x04
ZERO
CLEAR LOOP COUNTER
0 0 0 
WLOOP   TD     OUTPUT		TEST OUTPUT DEVICE
2064
WLOOP
TD
0xE0
OUTPUT
TEST OUTPUT DEVICE
0 0 0 
	JEQ    WLOOP		LOOP UNTIL READY
2067

JEQ
0x30
WLOOP
LOOP UNTIL READY
0 0 
	LDCH   BUFFER,X	        GET CHARCTER FROM BUFFER
206A

LDCH
0x50
BUFFER,X
GET CHARCTER FROM BUFFER
0 0 
	WD     OUTPUT		WRITE CHARACTER
206D

WD
0xDC
OUTPUT
WRITE CHARACTER
0 0 
	TIX    LENGTH		LOOP UNTIL ALL CHARACTERS
2070

TIX
0x2C
LENGTH
LOOP UNTIL ALL CHARACTERS
0 0 
	JLT    WLOOP	  	  HAVE BEEN WRITTEN
2073

JLT
0x38
WLOOP
HAVE BEEN WRITTEN
0 0 
	RSUB                    RETURN TO CALLER
2076

RSUB
0x4C

RETURN TO CALLER

OUTPUT  BYTE   X'05'		CODE FOR OUTPUT DEVICE
2079
OUTPUT
BYTE

X'05'
CODE FOR OUTPUT DEVICE
0 0 0 
	END    FIRST
-111

END

FIRST

0 0 0 0 
